–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ
–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å ZFS

–¶–µ–ª—å:
–Ω–∞—É—á–∏—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å ZFS, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—É–ª—ã, –∏–∑—É—á–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ZFS;


–û–ø–∏—Å–∞–Ω–∏–µ/–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è:

üéØ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?

1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º —Å –Ω–∞–∏–ª—É—á—à–∏–º —Å–∂–∞—Ç–∏–µ–º:
–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–∂–∞—Ç–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç zfs (gzip, zle, lzjb, lz4);
—Å–æ–∑–¥–∞—Ç—å 4 —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º—ã, –Ω–∞ –∫–∞–∂–¥–æ–π –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∂–∞—Ç–∏—è;
–¥–ª—è —Å–∂–∞—Ç–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–±–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, –ª–∏–±–æ –≥—Ä—É–ø–ø—É —Ñ–∞–π–ª–æ–≤.
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É–ª–∞.
–° –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã zfs import —Å–æ–±—Ä–∞—Ç—å pool ZFS.
–ö–æ–º–∞–Ω–¥–∞–º–∏ zfs –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
—Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞;
—Ç–∏–ø pool;
–∑–Ω–∞—á–µ–Ω–∏–µ recordsize;
–∫–∞–∫–æ–µ —Å–∂–∞—Ç–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è;
–∫–∞–∫–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
3. –†–∞–±–æ—Ç–∞ —Å–æ —Å–Ω–∞–ø—à–æ—Ç–∞–º–∏:
—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏;
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ. zfs receive;
–Ω–∞–π—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–µ secret_message.

1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å –Ω–∞–∏–ª—É—á—à–∏–º —Å–∂–∞—Ç–∏–µ–º
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ —É—Ç–∏–ª–∏—Ç ZFS
sudo apt install zfsutils-linux

–°–æ–∑–¥–∞–¥–∏–º 4–µ –ø—É–ª–∞ –¥–∏—Å–∫–æ–≤ –≤ —Ä–µ–∂–∏–º–µ RAID 1 
zpool create otus1 mirror /dev/sdb /dev/sdc
zpool create otus2 mirror /dev/sdd /dev/sde
zpool create otus3 mirror /dev/sdf /dev/sdg
zpool create otus4 mirror /dev/sdh /dev/sdi

–î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–∂–∞—Ç–∏—è
zfs set compression=lzjb otus1
zfs set compression=lz4 otus2
zfs set compression=gzip-9 otus3
zfs set compression=zle otus4

–°–∫–∞—á–∞–µ–º –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –≤–æ –≤—Å–µ –ø—É–ª—ã 
for i in {1..4}; do wget -P /otus$1 https://gutenberg.org/cache/epub/2600/pg2600.converter.log; done

–ü—Ä–æ–≤–µ—Ä–∏–º —Å–∫–æ–ª—å–∫–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–∞ —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ —Ä–∞–∑–Ω—ã—Ö –ø—É–ª–∞—Ö, –ø—Ä–æ–≤–µ—Ä–∏–º —Å—Ç–µ–ø–µ–Ω—å —Å–∂–∞—Ç–∏—è
zfs list
zfs get all | grep compressratio | grep -v ref

–ò–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∏–¥–Ω–æ, —á—Ç–æ —Å–∞–º–æ–µ –ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º gzip-9 (–≤ 3,48 —Ä–∞–∑–∞)

2.–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—É–ª–∞

–°–∫–∞—á–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –∞—Ä—Ö–∏–≤ –≤ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥
wget -O archive.tar.gz --no-check-certificate 'https://drive.usercontent.google.com/download?id=1MvrcEp-WgAQe57aDEzxSRalPAwbNN1Bb&export=download'

–†–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä—É–µ–º –µ–≥–æ –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ –ø—É–ª
tar -xzvf archive.tar.gz
zpool import -d zpoolexport/

–ó–∞—Ç–µ–º —Å–¥–µ–ª–∞–µ–º –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω–æ–≥–æ –ø—É–ª–∞ –∫ –Ω–∞–º –≤ –û–° –∏ –ø—Ä–æ–≤–µ—Ä–∏–º —Å—Ç–∞—Ç—É—Å
zpool import -d zpoolexport/ otus
zpool status

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
zpool get all otus
zfs get all otus

–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
zfs get available otus

–ï–≥–æ —Ç–∏–ø
zfs get readonly otus

–í—ã—è—Å–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ recordsize
zfs get recordsize otus

–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å–∂–∞—Ç–∏—è
zfs get comressratio otus

–ò —É–∑–Ω–∞–µ–º —Ç–∏–ø –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã
zfs get checksum otus

3. –†–∞–±–æ—Ç–∞ —Å–æ —Å–Ω–∞–ø—à–æ—Ç–æ–º

–°–∫–∞—á–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏–∑ –∑–∞–¥–∞–Ω–∏—è
wget -O otus_task2.file --no-check-certificate https://drive.usercontent.google.com/download?id=1wqxjih8YZ-cqLqaZVa01A3h3Y029c3oI&export=download

–í –º–æ–µ–º —Å–ª—É—á–∞–µ, –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã–ª–æ —É–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É otus –∏–∑ /

–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
zfs receive otus/test@today < otus_task2.file

–ò—â–µ–º —Ñ–∞–π–ª —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º secret_message
find  /otus/test -name "secret_message"

–û—Ç–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ –∏ –Ω–∞—Ö–æ–¥–∏–º —Å—Å—ã–ª–∫—É https://otus.ru/lessons/linux-hl/:
cat /otus/test/task1/file_mess/secret_message








